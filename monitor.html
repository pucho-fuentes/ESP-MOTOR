<!DOCTYPE html>
<html>
<head>
    <title>IMU Monitor</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<h2>ðŸ“Š Monitor IMU en tiempo real</h2>
<canvas id="chart"></canvas>
<p id="alert"></p>

<script>
const ctx = document.getElementById('chart').getContext('2d');
const chart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: [],
        datasets: [
            {label: 'AX', data: [], borderColor: 'red'},
            {label: 'AY', data: [], borderColor: 'green'},
            {label: 'AZ', data: [], borderColor: 'blue'}
        ]
    }
});

async function update() {
    const res = await fetch('/api/latest');
    const data = await res.json();

    chart.data.labels.push('');
    chart.data.datasets[0].data.push(data.ax);
    chart.data.datasets[1].data.push(data.ay);
    chart.data.datasets[2].data.push(data.az);

    if (chart.data.labels.length > 50) {
        chart.data.labels.shift();
        chart.data.datasets.forEach(d => d.data.shift());
    }

    chart.update();

    const alertRes = await fetch('/api/alert');
    const alertData = await alertRes.json();
    document.getElementById("alert").innerHTML =
        alertData.alert ? "ðŸš¨ VIBRACIÃ“N FUERTE" : "âœ… Normal";
}

setInterval(update, 200);
</script>
</body>
</html>
